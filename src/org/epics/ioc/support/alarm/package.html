<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
      "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="content-type" content="text/html; charset=iso-8859-1" />
  <title>EPICS JavaIOC: support</title>
</head>

<body>
<h1 style="text-align: center">EPICS JavaIOC: alarm support<br />
package: org.epics.ioc.alarm.support<br />
2010.01.08</h1>
CONTENTS 

<div class="toc">
<ul>
  <li><a href="#Overview">Overview</a></li>
  <li><a href="#definition">XML definitions For alarms</a> 
    <ul>
      <li><a href="#Numeric">Numeric Scalar</a></li>
      <li><a href="#Boolean">Boolean</a></li>
      <li><a href="#Enumerated">Enumerated</a></li>
    </ul>
  </li>
  <li><a href="#Alarm">Alarm Support</a></li>
  <li><a href="#Value">Value Alarms</a> 
    <ul>
      <li><a href="#Boolean1">Boolean Alarms</a></li>
      <li><a href="#Numeric1">Numeric Alarms</a></li>
      <li><a href="#Enumerated1">Enumerated Alarms</a></li>
    </ul>
  </li>
</ul>
</div>
<hr />

<h2 style="text-align: center" id="Overview">Overview</h2>
<hr />

<p>Support is provided for the alarm field itself and raising alarms for the
primitive types and for an enumerated structure.</p>

<p>The next section describes the xml syntax for attaching alarm support to a
value field and raising alarms for the value field. The remaining sections
describe the support. </p>

<p>Project pvData defines an alarm as follows:</p>
<pre>&lt;structure structureName = "alarmSeverity" extends = "enumerated" &gt;
  &lt;array name = "choices"  immutable = "true" &gt;
    [none,minor,major,invalid]&lt;/array&gt;
&lt;/structure&gt;

&lt;structure structureName = "alarm"&gt;
  &lt;structure name = "severity" extends = "alarmSeverity" /&gt;
  &lt;scalar name = "message" scalarType = "string" /&gt;
&lt;/structure&gt;</pre>

<p>Thus an alarm is defined by a structure that has two fields:</p>
<dl>
  <dt>severity</dt>
    <dd>An enumerated structure. An enumerated strtucture has just two
      fields: An integer field named index. It selects an element of the
      choices. The choices field is an immutable array of chracter strings
      with the values shown above.</dd>
  <dt>message</dt>
    <dd>A string field named message.</dd>
</dl>

<p>The following factories are provided:</p>
<dl>
  <dt>AlarmSupportFactory</dt>
    <dd>Complete support for field alarm.</dd>
  <dt>BooleanAlarmFactory</dt>
    <dd>Alarm support for boolean fields.</dd>
  <dt>ByteAlarmFactory</dt>
    <dd>Alarm support for byte fields.</dd>
  <dt>ShortAlarmFactory</dt>
    <dd>Alarm support for short fields.</dd>
  <dt>IntAlarmFactory</dt>
    <dd>Alarm support for int fields.</dd>
  <dt>LongAlarmFactory</dt>
    <dd>Alarm support for long fields.</dd>
  <dt>FloatAlarmFactory</dt>
    <dd>Alarm support for float fields.</dd>
  <dt>DoubleAlarmFactory</dt>
    <dd>Alarm support for double fields.</dd>
  <dt>EnumeratedAlarmFactory</dt>
    <dd>Alarm support for enum field..</dd>
</dl>
<hr />

<h2 style="text-align: center" id="definition">XML definitions For alarms</h2>
<hr />

<p>Support for raising alarms is provided for all the primitive types and for
an enumerated structure. Each can be defined for any field of a record that
has the corresponding type and has the field name "value". A record instance
can have multiple fields with associated alarm support. Since a structure can
have only one field named value, the top level of a structure can only have a
single alarm support but each substructure can also have alarm support. Three
basic types of support are provided: numeric, boolean, and enumerated. Each
is discussed in a separate section below.</p>

<h3 id="Numeric">Numeric Scalar</h3>

<p>Support is provided for all the numeric scalar types: byte, short, long,
float, and double. The following desription is for double but the support for
the other types is similar.</p>

<p>The structures associated with doubleAlarm are :</p>
<pre>&lt;structure structureName = "doubleAlarmInterval"&gt;
  &lt;scalar name = "value" scalarType = "double" /&gt;
  &lt;structure name = "severity" extends = "alarmSeverity" /&gt;
  &lt;scalar name = "message" scalarType = "string" /&gt;
&lt;/structure&gt;
&lt;structure structureName = "doubleAlarm" &gt;
  &lt;auxInfo name = "supportFactory" scalarType = "string"&gt;org.epics.ioc.doubleAlarmFactory&lt;/auxInfo&gt;
  &lt;scalar name = "active" scalarType = "boolean" /&gt;
  &lt;structure name = "interval" /&gt;
  &lt;structure name = "outOfRange"  extends = "alarmSeverity" /&gt;
  &lt;scalar name = "hystersis" scalarType = "double" /&gt;
&lt;/structure&gt;</pre>

<p>The doubleAlarm structure must appear in a structure at the same level as
a double scalar field named value. There must be an alarm field at the same
level. The doubleAlarm structure has the following fields:</p>
<dl>
  <dt>active</dt>
    <dd>Is alarm processing active?</dd>
  <dt>interval</dt>
    <dd>This is a structure. Each subfield of the structure must be a
      doubleAlarmInterval structure. The order of the subFields, not the
      name, detemines the interval order.</dd>
  <dt>outOfRange</dt>
    <dd>This is the alarmSeverity if the associated value field's value does
      not appear in any of the interval definitions.</dd>
</dl>

<p>A doubleAlarmInterval structure has the following fields:</p>
<dl>
  <dt>value</dt>
    <dd>This is the value for the interval. The alarm algoithm starts with
      the first interval and compares vaue with interval.value and if the
      result is &lt;= then this is the interval that is used to raise an
      alarm. If &gt; then it looks at the next interval. If no interval is
      found then outOfRange determines the alarm severity.</dd>
  <dt>severity</dt>
    <dd>The alarm severity for this interval.</dd>
  <dt>message</dt>
    <dd>The alarm message for this interval.</dd>
</dl>

<p>An example for a double field is:</p>
<pre>&lt;record recordName = "simpleExample" &gt;
    &lt;scalar name = "value"  scalarType = "double" /&gt;
    &lt;structure name = "alarm" extends = "alarm" /&gt;
    &lt;!-- definition of other field: timeStamp, input, etc --&gt;
    &lt;structure name = "valueAlarm" extends = "doubleAlarm"&gt;
          &lt;scalar name = "active"&gt;true&lt;/scalar&gt;
          &lt;structure name = "interval"&gt;
              &lt;structure name = "1" extends = "doubleAlarmInterval"&gt;
                  &lt;scalar name = "value"&gt;2.0&lt;/scalar&gt;
                  &lt;structure name = "severity"&gt;&lt;scalar name = "choice"&gt;major&lt;/scalar&gt;&lt;/structure&gt;
                  &lt;scalar name = "message"&gt;LOWLOW&lt;/scalar&gt;
              &lt;/structure&gt;
              &lt;structure name = "2" extends = "doubleAlarmInterval"&gt;
                  &lt;scalar name = "value"&gt;4.0&lt;/scalar&gt;
                  &lt;structure name = "severity"&gt;&lt;scalar name = "choice"&gt;minor&lt;/scalar&gt;&lt;/structure&gt;
                  &lt;scalar name = "message"&gt;LOW&lt;/scalar&gt;
              &lt;/structure&gt;
              &lt;structure name = "3" extends = "doubleAlarmInterval"&gt;
                  &lt;scalar name = "value"&gt;6.0&lt;/scalar&gt;
                  &lt;structure name = "severity"&gt;&lt;scalar name = "choice"&gt;none&lt;/scalar&gt;&lt;/structure&gt;
                  &lt;scalar name = "message"&gt;none&lt;/scalar&gt;
              &lt;/structure&gt;
              &lt;structure name = "4" extends = "doubleAlarmInterval"&gt;
                  &lt;scalar name = "value"&gt;8.0&lt;/scalar&gt;
                  &lt;structure name = "severity"&gt;&lt;scalar name = "choice"&gt;minor&lt;/scalar&gt;&lt;/structure&gt;
                  &lt;scalar name = "message"&gt;HIGH&lt;/scalar&gt;
              &lt;/structure&gt;
              &lt;structure name = "5" extends = "doubleAlarmInterval"&gt;
                  &lt;scalar name = "value"&gt;10.0&lt;/scalar&gt;
                  &lt;structure name = "severity"&gt;&lt;scalar name = "choice"&gt;major&lt;/scalar&gt;&lt;/structure&gt;
                  &lt;scalar name = "message"&gt;HIGHHIGH&lt;/scalar&gt;
              &lt;/structure&gt;
          &lt;/structure&gt;
          &lt;structure name ="outOfRange"&gt;&lt;scalar name = "choice"&gt;invalid&lt;/scalar&gt;&lt;/structure&gt;
    &lt;/structure&gt;
&lt;/record&gt;</pre>

<p>This example reproduces the semantics of alarm support for an EPICS V3 ai
record but the details are different. The above xml definition is for a
record instance but it could also apply to a substructure of a record if
record is replaced by structure in the above example. What is important is
that the structure has fields named value and alarm and that a structure
field that extends doubleAlarm is defined.</p>

<p>An arbitrary number of intervals can be defined. For example if only a
high alarm is needed than the following definition can be used:</p>
<pre>    &lt;structure name = "valueAlarm" extends = "doubleAlarm"&gt;
          &lt;scalar name = "active"&gt;true&lt;/scalar&gt;
          &lt;structure name = "interval"&gt;
              &lt;structure name = "1" extends = "doubleAlarmInterval"&gt;
                  &lt;scalar name = "value"&gt;6.0&lt;/scalar&gt;
                  &lt;structure name = "severity"&gt;&lt;scalar name = "choice"&gt;none&lt;/scalar&gt;&lt;/structure&gt;
                  &lt;scalar name = "message"&gt;none&lt;/scalar&gt;
              &lt;/structure&gt;
              &lt;structure name = "2" extends = "doubleAlarmInterval"&gt;
                  &lt;scalar name = "value"&gt;10.0&lt;/scalar&gt;
                  &lt;structure name = "severity"&gt;&lt;scalar name = "choice"&gt;major&lt;/scalar&gt;&lt;/structure&gt;
                  &lt;scalar name = "message"&gt;Really Bad Alarm&lt;/scalar&gt;
              &lt;/structure&gt;
          &lt;/structure&gt;
          &lt;structure name ="outOfRange"&gt;&lt;scalar name = "choice"&gt;invalid&lt;/scalar&gt;&lt;/structure&gt;</pre>

<h3 id="Boolean">Boolean</h3>

<p>A example of attaching alarm support to a boolean record or structure
is:</p>
<pre>&lt;record recordName = "booleanExample"&gt;
    &lt;scalar name = "value" scalarType = "boolean"/&gt;
    &lt;structure name = "alarm" extends = "alarm" /&gt;
    &lt;!-- definition of other field: timeStamp, input, etc --&gt;
    &lt;structure name = "timeStamp" extends = "timeStamp" /&gt;
    &lt;structure name = "valueAlarm" extends = "booleanAlarm"&gt;
      &lt;scalar name = "active"&gt;true&lt;/scalar&gt;
      &lt;structure name = "falseAlarm"&gt;&lt;scalar name = "choice"&gt;minor&lt;/scalar&gt;&lt;/structure&gt;
      &lt;scalar name = "falseMessage"&gt;false alarm&lt;/scalar&gt;
      &lt;structure name = "trueAlarm"&gt;&lt;scalar name = "choice"&gt;major&lt;/scalar&gt;&lt;/structure&gt;
      &lt;scalar name = "trueMessage"&gt;true alarm&lt;/scalar&gt;
    &lt;/structure&gt;
&lt;/record&gt;</pre>

<p>The booleanAlarm structure also has a fields named changeOfStateAlarm and
changeOfStateMessage. It semantics should be easy to see.</p>

<h3 id="Enumerated">Enumerated</h3>

<p>Before explaining the example let's first define the structures associated
with enumerated alarm support.</p>
<pre>&lt;structure structureName = "enumeratedAlarmState"&gt;
  &lt;structure name = "severity" extends = "alarmSeverity" /&gt;
  &lt;scalar name = "message" scalarType = "string" /&gt;
&lt;/structure&gt;

&lt;structure structureName = "enumeratedAlarm"&gt;
  &lt;auxInfo name = "supportFactory" scalarType = "string"&gt;org.epics.ioc.enumeratedAlarmFactory&lt;/auxInfo&gt;
  &lt;scalar name = "active" scalarType = "boolean" /&gt;
   &lt;!-- each stateAlarm field must be structure enumeratedAlarmState --&gt;
  &lt;structure name = "stateAlarm"/&gt;
  &lt;structure name = "changeStateAlarm" extends = "enumeratedAlarmState" /&gt;
&lt;/structure&gt;</pre>

<p>An enumerated structure appears in a structure at the same level as an
enumerated field named value. It has the fields:</p>
<dl>
  <dt>active</dt>
    <dd>Is alarm processing active?</dd>
  <dt>stateAlarm</dt>
    <dd>A structure field with sub fields each of which must be an
      enumeratedAlarmState structure. The fields must be named</dd>
  <dt>changeStateAlarm</dt>
    <dd>An enumeratedAlarmState for change of state.</dd>
</dl>

<p>An enumeratedAlarmState structure has the fields:</p>
<dl>
  <dt>severity</dt>
    <dd>An alarmSeverity enumerated field.</dd>
  <dt>message</dt>
    <dd>An alarm message.</dd>
</dl>

<p>The following shows how to create a record with enumerated alarms.</p>
<pre>&lt;record recordName = "enumerated"&gt;
    &lt;structure name = "value" extends = "enumerated"&gt;
        &lt;scalar name = "choices"&gt;[zero,one,two,three,four]&lt;/scalar&gt;
    &lt;/structure&gt;
    &lt;structure name = "alarm" extends = "alarm" /&gt;
    &lt;structure name = "timeStamp" extends = "timeStamp" /&gt;
    &lt;structure name = "valueAlarm" extends = "enumeratedAlarm"&gt;
            &lt;scalar name = "active"&gt;true&lt;/scalar&gt;
            &lt;structure name = "stateAlarm"&gt;
                 &lt;structure name = "0" extends = "enumeratedAlarmState"&gt;
                      &lt;scalar name = "value"&gt;0&lt;/scalar&gt;
                      &lt;structure name = "severity"&gt;&lt;scalar name = "choice"&gt;major&lt;/scalar&gt;&lt;/structure&gt;
                      &lt;scalar name = "message"&gt;ZERO ALARM&lt;/scalar&gt;
                 &lt;/structure&gt;
                 &lt;structure name = "1" extends = "enumeratedAlarmState"&gt;
                      &lt;scalar name = "value"&gt;1&lt;/scalar&gt;
                      &lt;structure name = "severity"&gt;&lt;scalar name = "choice"&gt;minor&lt;/scalar&gt;&lt;/structure&gt;
                      &lt;scalar name = "message"&gt;ONE ALARM&lt;/scalar&gt;
                 &lt;/structure&gt;
                 &lt;structure name = "2" extends = "enumeratedAlarmState"&gt;
                      &lt;scalar name = "value"&gt;2&lt;/scalar&gt;
                      &lt;structure name = "severity"&gt;&lt;scalar name = "choice"&gt;none&lt;/scalar&gt;&lt;/structure&gt;
                      &lt;scalar name = "message"&gt;TWO ALARM&lt;/scalar&gt;
                 &lt;/structure&gt;
                 &lt;structure name = "3" extends = "enumeratedAlarmState"&gt;
                      &lt;scalar name = "value"&gt;3&lt;/scalar&gt;
                      &lt;structure name = "severity"&gt;&lt;scalar name = "choice"&gt;minor&lt;/scalar&gt;&lt;/structure&gt;
                      &lt;scalar name = "message"&gt;THREE ALARM&lt;/scalar&gt;
                 &lt;/structure&gt;
                 &lt;structure name = "4" extends = "enumeratedAlarmState"&gt;
                      &lt;scalar name = "value"&gt;4&lt;/scalar&gt;
                      &lt;structure name = "severity"&gt;&lt;scalar name = "choice"&gt;major&lt;/scalar&gt;&lt;/structure&gt;
                      &lt;scalar name = "message"&gt;FOUR ALARM&lt;/scalar&gt;
                 &lt;/structure&gt;
            &lt;/structure&gt;
            &lt;structure name = "changeStateAlarm"&gt;
                 &lt;structure name = "severity"&gt;&lt;scalar name = "choice"&gt;none&lt;/scalar&gt;&lt;/structure&gt;
                 &lt;scalar name = "message"&gt;Change State&lt;/scalar&gt;
             &lt;/structure&gt;
    &lt;/structure&gt;
&lt;/record&gt;</pre>

<p>Another way to create enumerated alarm support is via support digital. The
following is an example:</p>
<pre>&lt;record recordName = "enumerated"&gt;
    &lt;structure name = "value" extends = "enumerated"/&gt;
    &lt;structure name = "alarm" extends = "alarm" /&gt;
    &lt;structure name = "timeStamp" extends = "timeStamp" /&gt;
    &lt;structure name = "input" extends = "digital"&gt;
        &lt;structure name = "alarm" extends = "alarm" /&gt;
        &lt;structure name = "states" &gt;
             &lt;auxInfo name = "supportFactory" scalarType = "string"&gt;org.epics.ioc.digitalInputFactory&lt;/auxInfo&gt;
             &lt;structure name = "0" extends = "digitalState"&gt;
                 &lt;scalar name = "name"&gt;zero&lt;/scalar&gt;
                 &lt;scalar name = "value"&gt;0&lt;/scalar&gt;
                 &lt;structure name = "severity"&gt;&lt;scalar name = "choice"&gt;major&lt;/scalar&gt;&lt;/structure&gt;
                 &lt;scalar name = "message"&gt;ZERO ALARM&lt;/scalar&gt;
             &lt;/structure&gt;
             &lt;structure name = "1" extends = "digitalState"&gt;
                 &lt;scalar name = "name"&gt;one&lt;/scalar&gt;
                 &lt;scalar name = "value"&gt;1&lt;/scalar&gt;
                 &lt;structure name = "severity"&gt;&lt;scalar name = "choice"&gt;none&lt;/scalar&gt;&lt;/structure&gt;
             &lt;/structure&gt;
             &lt;structure name = "2" extends = "digitalState"&gt;
                 &lt;scalar name = "name"&gt;two&lt;/scalar&gt;
                 &lt;scalar name = "value"&gt;2&lt;/scalar&gt;
                 &lt;structure name = "severity"&gt;&lt;scalar name = "choice"&gt;none&lt;/scalar&gt;&lt;/structure&gt;
             &lt;/structure&gt;
             &lt;structure name = "3" extends = "digitalState"&gt;
                 &lt;scalar name = "name"&gt;three&lt;/scalar&gt;
                 &lt;scalar name = "value"&gt;3&lt;/scalar&gt;
                 &lt;structure name = "severity"&gt;&lt;scalar name = "choice"&gt;minor&lt;/scalar&gt;&lt;/structure&gt;
                 &lt;scalar name = "message"&gt;THREE ALARM&lt;/scalar&gt;
             &lt;/structure&gt;
             &lt;structure name = "4" extends = "digitalState"&gt;
                 &lt;scalar name = "name"&gt;four&lt;/scalar&gt;
                 &lt;scalar name = "value"&gt;4&lt;/scalar&gt;
                 &lt;structure name = "severity"&gt;&lt;scalar name = "choice"&gt;major&lt;/scalar&gt;&lt;/structure&gt;
                 &lt;scalar name = "message"&gt;FOUR ALARM&lt;/scalar&gt;
             &lt;/structure&gt;
        &lt;/structure&gt;
    &lt;/structure&gt;
    &lt;structure name = "valueAlarm" extends = "enumeratedAlarm"&gt;
            &lt;scalar name = "active"&gt;true&lt;/scalar&gt;
            &lt;structure name = "changeStateAlarm"&gt;
                 &lt;structure name = "severity"&gt;&lt;scalar name = "choice"&gt;none&lt;/scalar&gt;&lt;/structure&gt;
                 &lt;scalar name = "message"&gt;Change State&lt;/scalar&gt;
             &lt;/structure&gt;
    &lt;/structure&gt;
&lt;/record&gt;</pre>

<p>The digitalInput support does the folowing:</p>
<ul>
  <li>It looks at each digitalState defined in input.states.</li>
  <li>It uses the name fields to set the record.value.choices.</li>
  <li>It uses the value field to determine the record.value.index when
    process is called.</li>
  <li>It uses the severity and message fields to create enumeratedAlarmState
    structures and add them to the record.valueAlarm.stateAlarm
  structure.</li>
  <li>Note that digitalState.value is NOT an index for the record.value
    field. The digital structure also must have an integer field named value.
    It is assumed to be a register integer value. The digitalState.value is
    compared with digital.value. If they are equal than this is the
    digitalState that is used to set record.value.index. The order of the
    digitalState fields determines the value of record.value.index. For
    example digitalState.value could be set to "0x11". portDriver provides
    support for digital devices that provides additional features that allow
    an arbitray set of bits of a register to be selected.</li>
</ul>

<p>The enumeratedAlarm support looks at the current and previous value of the
record value.index and raises and alarm based on the valueAlarm settings.</p>
<hr />

<h2 style="text-align: center" id="Alarm">Alarm Support</h2>
<hr />

<p>AlarmSupport is support for a field named which must have type structure
and the structure must be an alarm structure. Within the structure hierarchy
of a record multiple alarm fields can exist. Some support, e.g. generic,
calls the support for the alarm field defined in the top level structure
(defined in common.xml). If multiple alarm fields reside in a record then the
top level alarm field, which is what the outside world normally accesses has
a severity at least as great as any of the lower level alarms.</p>
<pre>interface AlarmSupport extends Support{
    void beginProcess();
    void endProcess();
    boolean setAlarm(String message, AlarmSeverity severity);
    Alarm getAlarm();
}

class AlarmSupportFactory {
    public static Support create(PVStructureStructure)
    public static AlarmSupport getAlarmSupport(PVField pvField,RecordSupport recordSupport);
}</pre>

<p>AlarmSupport provides the methods:</p>
<dl>
  <dt style="font-family: courier;">Support</dt>
    <dd>Standard support methods..</dd>
  <dt style="font-family: courier;">beginProcess</dt>
    <dd>This is called when a field begins processing. It must be called by
      support for the structure that has alarm as a subfield. Support generic
      calls it.</dd>
  <dt style="font-family: courier;">endProcess</dt>
    <dd>This is called when a record finishes processing.It must be called by
      support for the structure that has alarm as a subfield. Support generic
      calls it. If setAlarm was not called since beginProcess was called than
      it makes sure that the severity is noAlarm. If the severity and/or
      message was changed during record processing it calls postPut.</dd>
  <dt style="font-family: courier;">setAlarm</dt>
    <dd>While a record is processing code, normally another support module,
      can call setAlarm. This method changes the new message and severity
      only if the severity passed to setAlarm is greater than the current new
      severity or if this is the first call since the record started
      processing.</dd>
  <dt style="font-family: courier;">getAlarm</dt>
    <dd>Get the Alarm interface. This interface is defined in
      org.epics.pvData.property.</dd>
</dl>

<p>AlarmFactory provides the static methods:</p>
<dl>
  <dt style="font-family: courier;">create</dt>
    <dd>Create support for a alarm field. This is called by
    SupportCreation.</dd>
  <dt style="font-family: courier;">getAlarmSupport</dt>
    <dd>Get the alarm support for the field or return null if none is
    found.</dd>
</dl>
<hr />

<h2 style="text-align: center" id="Value">Value Alarms</h2>
<hr />

<p>Support is provided for alarms for the following types of fields: boolean,
numeric, and enumerated.</p>

<h3 id="Boolean1">Boolean Alarms</h3>
<pre>    public class BooleanAlarmFactory {
        public static Support create(PVStructure pvStructure);
    }</pre>

<p>This provides support for reporting alarms for boolean fields. The
configurationStructure must be a structure booleanAlarm, which has the
fields:</p>
<dl>
  <dt style="font-family: courier;">active</dt>
    <dd>A boolean field. If (false,true) then alarm conditions (are not,are)
      checked.</dd>
  <dt style="font-family: courier;">falseAlarm</dt>
    <dd>An alarmSeverity menu. This specifies the severity if the value field
      is false.</dd>
  <dt style="font-family: courier;">trueAlarm</dt>
    <dd>An alarmSeverity menu. This specifies the severity if the value field
      is true.</dd>
  <dt style="font-family: courier;">changeStateAlarm</dt>
    <dd>An alarmSeverity menu. This specifies the severity if the value field
      changes.</dd>
</dl>

<h3 id="Numeric1">Numeric Alarms</h3>
<pre>    public class ByteAlarmFactory {
        public static Support create(PVStructure pvStructure);
    }
    public class ShortAlarmFactory {
        public static Support create(PVStructure pvStructure);
    }
    public class IntAlarmFactory {
        public static Support create(PVStructure pvStructure);
    }
    public class LongAlarmFactory {
        public static Support create(PVStructure pvStructure);
    }
    public class FloatAlarmFactory {
        public static Support create(PVStructure pvStructure);
    }
    public class DoubleAlarmFactory {
        public static Support create(PVStructure pvStructure);
    }</pre>

<p>The above factories provide alarm support for the associated type of
field, e.g. FloatAlarmFactory provides alarm support for a field of type
float. The support for each type except that float and double also support
hystersis, which is described below. Each has two associated xml structure
definitions. For example the definitions for double are:</p>
<pre>&lt;structure name = "doubleAlarmInterval"&gt;
  &lt;scalar name = "value" type = "double" /&gt;
  &lt;structure name = "severity" type = "alarmSeverity" /&gt;
  &lt;scalar name = "message" type = "string" /&gt;
&lt;/structure&gt;
&lt;structure name = "doubleAlarm" &gt;
  &lt;auxInfo name = "supportFactory" type = "string"&gt;doubleAlarmFactory&lt;/auxInfo&gt;
  &lt;scalar name = "active" type = "boolean" /&gt;
  &lt;structure name = "interval" /&gt;
  &lt;structure name = "outOfRange" type = "alarmSeverity" /&gt;
  &lt;scalar name = "hystersis" type = "double" /&gt;
&lt;/structure&gt;</pre>

<p>The first structure defines an interval for alarm checking. It has the
fields:</p>
<dl>
  <dt style="font-family: courier;">value</dt>
    <dd>The upper bound for a value.</dd>
  <dt style="font-family: courier;">severity</dt>
    <dd>The alarm severity for a value that falls into this interval.</dd>
  <dt style="font-family: courier;">message</dt>
    <dd>The alarm message for a value that falls into this interval.</dd>
</dl>

<p>The second structure has the following fields:</p>
<dl>
  <dt style="font-family: courier;">active</dt>
    <dd>A boolean field. If (false,true) then alarm conditions (are not,are)
      checked.</dd>
  <dt style="font-family: courier;">interval</dt>
    <dd>A array of intervals. When the process method of value alarm support
      is called it looks for the interval for the current value. It starts
      with the first interval and continues until it finds an interval such
      that value&lt;=interval.value. This determines the alarm severity.</dd>
  <dt style="font-family: courier;">outOfRange</dt>
    <dd>The alarm severity if no interval is found.</dd>
  <dt style="font-family: courier;">hystersis</dt>
    <dd>If value goes into alarm this is the amount it must come out of alarm
      before the alarm severity is modified. This prevents alarm .</dd>
</dl>

<h3 id="Enumerated1">Enumerated Alarms</h3>
<pre>    public class EnumeratedAlarmFactory {
        public static Support create(PVStructure pvStructure);
    }</pre>

<p>The above factory provides support for an enumerated structure field.</p>

<p>The enumeratedAlarm structure has the following fields:</p>
<dl>
  <dt style="font-family: courier;">active</dt>
    <dd>A boolean field. If (false,true) then alarm conditions (are not,are)
      checked.</dd>
  <dt style="font-family: courier;">stateSeverity</dt>
    <dd>An array of stateSeverity alarmSeverity menu definitions. When the
      process method is called the value field is the index for this array.
      The corresponding alarmSeverity menu is found and it determines the
      alarm severity.</dd>
  <dt style="font-family: courier;">changeStateAlarm</dt>
    <dd>An alarmSeverity menu. This specifies the severity if the value field
      changes.</dd>
</dl>
</body>
</html>
