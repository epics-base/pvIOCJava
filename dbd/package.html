<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
       "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="content-type" content="text/html; charset=iso-8859-1" />
  <title>EPICS JavaIOC: support</title>
</head>

<body>
<h1 style="text-align: center">EPICS JavaIOC: dbd<br />
2007.08.02</h1>
CONTENTS

<hr />

<h2 style="text-align: center">Overview</h2>
<hr />

<p>This package describes the Database Definition Files in javaIOC/dbd.</p>
<dl>
  <dt style="font-family: courier;">menu.xml</dt>
    <dd>Standard menu definitions.</dd>
  <dt style="font-family: courier;">structure.xml</dt>
    <dd>Standard structure definitions.</dd>
  <dt style="font-family: courier;">support.xml</dt>
    <dd>Support definitions for support implemented by javaIOC.</dd>
  <dt style="font-family: courier;">common.xml</dt>
    <dd>Database Definitions for fields that are normally part of every
      record type.</dd>
  <dt style="font-family: courier;">menuStructureSupport.xml</dt>
    <dd>Includes the menu, structure, and support definitions.</dd>
  <dt style="font-family: courier;">recordType.xml</dt>
    <dd>Includes all the record/structure definitions listed next.</dd>
  <dt style="font-family: courier;">pdrv.xml</dt>
    <dd>All the definitions required by portDriver.</dd>
</dl>
<p>In addition it defines Database Definitions for the following structure
and record types:</p>
<ul>
  <li>boolean</li>
  <li>byte</li>
  <li>short</li>
  <li>int</li>
  <li>long</li>
  <li>float</li>
  <li>double</li>
  <li>string</li>
  <li>booleanArray</li>
  <li>byteArray</li>
  <li>shortArray</li>
  <li>intArray</li>
  <li>longArray</li>
  <li>floatArray</li>
  <li>doubleArray</li>
  <li>stringArray</li>
  <li>aiDouble</li>
  <li>aoDouble</li>
  <li>aoIncrementalDouble</li>
  <li>digital</li>
  <li>event</li>
  <li>calcDouble</li>
  <li>calcDoubleArray</li>
  <li>calcBooleanArray</li>
  <li>powerSupply</li>
</ul>
<p>For each of the above a structure and a recordType are defined. This each type
can be a standalone record or embeded within a "device" record. The associated
support works for both.</p>

<h2 style="text-align: center;">Standard Database
Definitions</h2>
<hr />

<h3>menu.dbd</h3>

<p>Definitions for the following menus:</p>
<dl>
  <dt>priority</dt>
    <dd>The scan priorities: lowest,...,highest</dd>
  <dt>scan</dt>
    <dd>The scan types:
      <dl>
        <dt>passive</dt>
          <dd>A record that is neither periodically or event scanned.
            Something elase can make it process. For example anothe record
            with a process link.</dd>
        <dt>event</dt>
          <dd>An event scanned record. In this case an eventName is also
            assigned to the record.</dd>
        <dt>periodioc</dt>
          <dd>A periodically scanned record. In this case a rate is also
            assigned to the record.</dd>
      </dl>
    </dd>
  <dt>alarmSeverity</dt>
    <dd>The alarm severities: none,minor,major,invalid</dd>
  <dt>monitorType</dt>
    <dd>The types put, change, absoluteChange, and percentageChange.</dd>
  <dt>outputMode</dt>
    <dd>This is for use by aoIncremental records. The modes are supervisory and closedLoop.</dl>
</dl>

<h3>structure.xml</h3>

<p>Definitions for the following structures:</p>
<dl>
  <dt>timeStamp</dt>
  <dl>
    <dt>secondsPastEpoch</dt>
      <dd>Seconds past the epoch which is Jan 1, 1970 UTC. This is compatible
        with Java and POSIX.</dd>
    <dt>nanoSeconds</dt>
      <dd>nanoseconds within the second.</dd>
  </dl>
  <dt>scan</dt>
  <dl>
    <dt>priority</dt>
      <dd>The thread priority for a periodic and event scanning.</dd>
    <dt>scan</dt>
      <dd>Scan type, i.e. passive, event, or periodic</dd>
    <dt>rate</dt>
      <dd>Periodic scan rate in seconds</dd>
    <dt>eventName</dt>
      <dd>The event name for event scanned records.</dd>
    <dt>processSelf</dt>
      <dd>Should the record process itself?</dd>
  </dl>
   <dt>alarm</dt>
    <dd>Has fields severity and message. common.xml has a field
    named alarm which is an alarm structure.</dd>
   <dt>byteAlarm,byteAlarmInterval,...doubleAlarm,doubleAlarmInterval</dt>
    <dd>Each set of structures is used to define an arbitrary set of alarm intervals
    for fields that have the associated numeric type.</dd>
   <dt>booleanAlarm</dt>
    <dd>Used to define alarms for a boolean field.</dd>
   <dt>digitalAlarm,digitalState</dt>
    <dd>Used to define alarms for a digital record.</dd>
  <dt>incrementalDouble</dt>
    <dd>Defines the fields required to implement recordType aoIncrementalDouble.</dd>
  <dt>digitalIO</dt>
    <dd>Defines the fields required to implement recordType digital.</dd>
  <dt>delayLink</dt>
    <dd>A configuration structure used by the delayLink support.</dd>
  <dt>processLink</dt>
  <dl>
    <dt>pvname</dt>
      <dd>recordName.fieldName of link</dd>
    <dt>inheritSeverity</dt>
      <dd>Should this record be put in alarm if the linked record is in
      alarm?</dd>
  </dl>
  <dt>monitorLink</dt>
  <dl>
    <dt>pvname</dt>
      <dd>recordName.fieldName of link</dd>
    <dt>type</dt>
      <dd>A monitorType menu.</dd>
    <dt>deadband</dt>
      <dd>If monitorType is absoluteChange or percentageChange this is the
        deadband for reporting monitors.</dd>
    <dt>onlyWhileProcessing</dt>
      <dd>Look only for changes while record is being processed.</dd>
    <dt>queueSize</dt>
      <dd>Must be greater than 1. The default is 2.</dd>
    <dt>reportOverrun</dt>
      <dd>If the data queue is overrun should it be reported by setting
        status and severity?</dd>
    <dt>process</dt>
      <dd>Should the record containing the link be processed after the
        monotered data is read.</dd>
    <dt>inheritSeverity</dt>
      <dd>Should this record be put in alarm if the linked record is in
      alarm?</dd>
  </dl>
  <dt>monitorNotifyLink</dt>
  <dl>
    <dt>pvname</dt>
      <dd>recordName.fieldName of link</dd>
    <dt>type</dt>
      <dd>A monitorType menu.</dd>
    <dt>deadband</dt>
      <dd>If monitorType is absoluteChange or percentageChange this is the
        deadband for reporting monitors.</dd>
    <dt>onlyWhileProcessing</dt>
      <dd>Look only for changes while record is being processed.</dd>
  </dl>
  <dt>inputLink</dt>
  <dl>
    <dt>pvname</dt>
      <dd>recordName.fieldName of link</dd>
    <dt>process</dt>
      <dd>Should the linked record be processed before getting data?</dd>
    <dt>inheritSeverity</dt>
      <dd>Should this record be put in alarm if the linked record is in
      alarm?</dd>
  </dl>
  <dt>outputLink</dt>
  <dl>
    <dt>pvname</dt>
      <dd>recordName.fieldName of link</dd>
    <dt>process</dt>
      <dd>Should the linked record be processed after putting data?</dd>
    <dt>inheritSeverity</dt>
      <dd>Should this record be put in alarm if the linked record is in
      alarm?</dd>
  </dl>
  <dt>disableLink</dt>
    <dd>Defined but not used. Support must be created.</dd>
  <dt>linkArrayElement</dt>
  <dl>
    <dt>wait</dt>
      <dd>After this link is started should linkArraySupport wait for
        completion of all links currently started before starting the next
        link.</dd>
    <dt>link</dt>
      <dd>A database link</dd>
    <dt>name</dt>
      <dd>A name that can be used is desired. For example a calculation
        record (not implemented) could use it.</dd>
  </dl>
  <dt>displayLimit</dt>
    <dd>Can be used as needed.</dd>
  <dt>linearConvert</dt>
    <dd>
      Used for linear conversions. The slope and intercept can be specified
     directly or can be computed from the other four fields. Normally
    the record instance defines engUnitsLow and engUnitsHigh and support code
    provides values for deviceHigh and deviceLow but other combinations
    are also permitted.</dd>
    <ul>
       <li>engUnitsLow</li>
       <li>engUnitsHigh</li>
       <li>deviceHigh</li>
       <li>deviceLow</li>
       <li>slope</li>
       <li>intercept</li>
    </ul>
     </dd>
  <dt>link</dt>
    <dd>This is a structure with a single field named link that has type link.
     The supportName is also link. This is used for a structure field that has the
     structure type defined only when a record instance is being defined.
     The default support calls the support for the link field. This is an "adaptor"
    that allows standard link support for a field that is defined to be a structure.</dd>
  <dt>byteLimit,...,doubleLimit</dl>
    <dd>Each of these has two fields: low and high. These provide limits for
   each numeric data type.</dd>
</dl>

<h3>support.xml</h3>

<p>Definitions for the following support:</p>
<dl>
  <dt>noop</dt>
    <dd>Both support and linkSupport are implemented. The support always completes
     successfully and synchronously.</dd>
  <dt>link</dt>
    <dd>Support for a structure with structureName link. It invokes the
    support for the link field of the structure. The support is "adaptor"
    support for a field that is a structure buth for a record instance link
   support is desired.</dd>
  <dt>linearConvertInput</dt>
    <dd>implemented.</dd>
  <dt>linearConvertOutput</dt>
    <dd>implemented.</dd>
  <dt>linkArray</dt>
     <dd>Support for a array of links.</dd>
  <dt>processLink</dt>
  <dt>monitorLink</dt>
  <dt>monitorNotifyLink</dt>
  <dt>inputLink</dt>
  <dt>outputLink</dt>
  <dt>event</dt>
    <dd>Support for an event record or structure</dd>
  <dt>digital</dt>
    <dd>Support for a digital record.</dd>
  <dt>incremental</dt>
    <dd>Support for an incremental output record.</dd>
  <dt>scan</dt>
    <dd>Support for the scan field. This is called by recordProcess. This all
      records that have a scan field as a top level field can be periodically
      or event scanned.</dd>
  <dt>alarm</dt>
    <dd>Support for an alarm field.</dd>
  <dt>calcArgArray</dt>
    <dd>Support for the array of arguments for a calculation record.</dd>
  <dt>booleanAlarm,...,doubleAlarm,digitalAlarm</dt>
     <dd>alarm support for fields with the corresponding data type.</dd>
   <dt>generic</dt>
    <dd>Support for a recordType or structure. It calls the support for
     each field that has associated support
     except for fields named alarm, scan, and timeStamp.
    It calls each support in the order the fields appear in the structure
   and waits for each support to complete before it call the next support.
   It also looks for a field named value and calls the setField method of each
   support with this field if it is found or if it's own setField was called.</dd>
   <dt>counterCalculator,arrayIncrementCalculator,booleanArrayToggleCalculator</dt>
    <dd>Calculators used for examples and for testing.</dd>

</dl>

<h3>common.xml</h3>

<p>This has definitions for fields that are common to all (most?) record
types.</p>
<pre>
&lt;?xml version="1.0" ?&gt;
&lt;DBDefinition&gt;
    &lt;field name = "timeStamp" type = "structure" structureName = "timeStamp"/&gt;
    &lt;field name = "scan" type = "structure" structureName = "scan"
         supportName = "scan" /&gt;
    &lt;field name = "processAfterStart" type = "boolean" default = "false"/&gt;
&lt;/DBDefinition&gt;
</pre>

<p>For example a record type for a double record could start with:</p>
<pre>
&lt;?xml version="1.0" ?&gt;
&lt;DBDefinition&gt;
&lt;include addPath = "src/org/epics/ioc/support" /&gt;

&lt;recordType name = "doubleRecord" supportName = "doubleRecord" &gt;
    &lt;include href = "common.xml" /&gt;</pre>
</body>
</html>
